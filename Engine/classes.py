
# These classes are all for convenient passing of variables between the main code, the telluric spectrum fitter, and the model function.

import numpy as np

class fitobjs:


    def __init__(self,s, x, u,continuum,watm_in,satm_in,mflux_in,mwave_in,mask):
        self.s = s
        self.x = x
        self.u = u
        self.continuum = continuum
        self.watm_in = watm_in
        self.satm_in = satm_in
        self.mflux_in = mflux_in
        self.mwave_in = mwave_in
        self.mask = mask

class inparams:

    def __init__(self,inpath,outpath,initvsini,vsinivary,plotfigs,initguesses,bvcs,tagsA,tagsB,nights,mwave,mflux,a0dict,xbounddict,maskdict):
        self.inpath      = inpath
        self.outpath     = outpath
        self.initvsini   = initvsini
        self.vsinivary   = vsinivary
        self.plotfigs    = plotfigs
        self.initguesses = initguesses
        self.bvcs        = bvcs
        self.tagsA       = tagsA
        self.tagsB       = tagsB
        self.mwave0      = mwave
        self.mflux0      = mflux
        self.nights      = nights
        self.a0dict      = a0dict
        self.xbounddict  = xbounddict
        self.maskdict = maskdict
        self.ips_tightmount_pars = { 'H':{
                                            2: np.array([-0.00000127, +0.00210607, 3.6192607]),
                                            3: np.array([-0.00000086, +0.00113201, 3.6564603]),
                                            4: np.array([-0.00000173, +0.00253586, 3.5631968]),
                                            5: np.array([-0.00000041, +0.00041207, 3.7637662]),
                                            6: np.array([-0.00000139, +0.00183241, 3.6774443]),
                                            10: np.array([-0.00000031, +0.00002004, 3.7771402]),
                                            11: np.array([-0.00000011, -0.00016688, 3.6592567]),
                                            13: np.array([-0.00000053, -0.00002286, 3.6559695]),
                                            14: np.array([-0.00000023, +0.00003049, 3.6390489]),
                                            16: np.array([-0.00000010, -0.00031187, 3.7221495]),
                                            17: np.array([+0.00000045, -0.00120338, 3.4309781]),
                                            20: np.array([+0.00000005, -0.00057104, 3.2301115]),
                                            21: np.array([-0.00000004, -0.00049309, 3.4893479]),
                                            22: np.array([-0.00000005, -0.00031042, 3.3796082])},
                                    'K':{   2: np.array([-0.00000043, -0.00009260, 3.0418921]),
                                            3: np.array([-0.00000029, -0.00045505, 3.4133542]),
                                            4: np.array([-0.00000022, -0.00023683, 3.4237835]),
                                            5: np.array([+0.00000020, -0.00084550, 3.4077089]),
                                            6: np.array([-0.00000007, -0.00049691, 3.4352272]),
                                            7: np.array([+0.00000019, -0.00081209, 3.4240662]),
                                            8: np.array([+0.00000037, -0.00108785, 3.3656891]),
                                            10: np.array([+0.00000003, -0.00065472, 3.0381728]),
                                            11: np.array([+0.00000013, -0.00093724, 3.3202425]),
                                            12: np.array([+0.00000013, -0.00130973, 3.2355903]),
                                            13: np.array([+0.00000000, -0.00117662, 3.0231885]),
                                            14: np.array([+0.00000036, -0.00153806, 3.3215094]),
                                            16: np.array([+0.00000079, -0.00127711, 2.8699976]) }
                                    }

        self.ips_loosemount_pars = { 'H':{
                                            2: np.array([-0.00000097, +0.00180228, 3.627852]),
                                            3: np.array([-0.00000083, +0.00098296, 3.7694351]),
                                            4: np.array([-0.00000179, +0.00256885, 3.5411249]),
                                            5: np.array([-0.00000014, +0.00004835, 3.7027478]),
                                            6: np.array([-0.00000137, +0.00197794, 3.5727618]),
                                            10: np.array([-0.00000014, -0.00012634, 3.7969074]),
                                            11: np.array([-0.00000001, -0.00028753, 3.7904194]),
                                            13: np.array([-0.00000044, -0.00007479, 3.7152577]),
                                            14: np.array([-0.00000003, -0.00027106, 3.7964484]),
                                            16: np.array([-0.00000001, -0.00036968, 3.7979411]),
                                            17: np.array([-0.00000000, -0.00055775, 3.4072676]),
                                            20: np.array([+0.00000000, -0.00051203, 3.3113866]),
                                            21: np.array([+0.00000000, -0.00053837, 3.4698927]),
                                            22: np.array([-0.00000007, -0.00018335, 3.266584]) },
                                    'K':{   2: np.array([-0.00000100, +0.00133316, 3.6138606]),
                                            3: np.array([-0.00000068, +0.00070342, 3.7882576]),
                                            4: np.array([-0.00000093, +0.00126044, 3.7993036]),
                                            5: np.array([-0.00000049, +0.00036114, 3.7983821]),
                                            6: np.array([-0.00000044, +0.00024862, 3.795974]),
                                            7: np.array([-0.00000046, +0.00033508, 3.7726949]),
                                            8: np.array([-0.00000008, -0.00049619, 3.7995246]),
                                            10: np.array([+0.00000000, -0.00077256, 3.7998719]),
                                            11: np.array([+0.00000000, -0.00075347, 3.6738797]),
                                            12: np.array([-0.00000000, -0.00107012, 3.2094447]),
                                            13: np.array([+0.00000000, -0.00122076, 3.1116611]),
                                            14: np.array([-0.00000000, -0.00104468, 3.7994558]),
                                            16: np.array([+0.00000029, -0.00070009, 3.0229969]) }
                                    }


        #                                                 5           6           13          14          16         21          22
        self.methodvariance_tight = { 'H': np.array([0.03398632, 0.02377757, 0.00720531, 0.00644566, 0.00195402, 0.05281015, 0.01480054]),
        #                                                 3          4           5           6
                                      'K': np.array([0.00363236, 0.00197544, 0.00141994, 0.00072611])
                                    }
        self.methodvariance_loose = { 'H': np.array([np.nan    , np.nan    , np.nan    , np.nan    ]),
                                      'K': np.array([0.01378011, 0.01622701, 0.00350221, 0.00146749])
                                    }
        self.bound_cut_dic = { 'H':{
                                    10: [250, 150],
                                    11: [600, 150],
                                    13: [200, 600],
                                    14: [700, 100],
                                    16: [400, 100],
                                    17: [1000,100],
                                    20: [500, 150]},
                               'K':{
                                    13: [200, 400],
                                    14: [200, 400]}
                            }

class inparamsA0:

    def __init__(self,inpath,outpath,plotfigs,tags,nights,humids,temps,zds,press,obs,watm,satm,mwave,mflux,cdbsloc,xbounddict,maskdict):
        self.inpath = inpath
        self.outpath = outpath
        self.plotfigs = plotfigs
        self.tags = tags
        self.humids = humids
        self.temps = temps
        self.zds = zds
        self.press = press
        self.obses = obs
        self.watm = watm
        self.satm = satm
        self.mwave0 = mwave
        self.mflux0 = mflux
        self.nights = nights
        self.cdbsloc = cdbsloc
        self.xbounddict  = xbounddict
        self.maskdict = maskdict
        self.ips_tightmount_pars = { 'H':{
                                            2: np.array([-0.00000127, +0.00210607, 3.6192607]),
                                            3: np.array([-0.00000086, +0.00113201, 3.6564603]),
                                            4: np.array([-0.00000173, +0.00253586, 3.5631968]),
                                            5: np.array([-0.00000041, +0.00041207, 3.7637662]),
                                            6: np.array([-0.00000139, +0.00183241, 3.6774443]),
                                            10: np.array([-0.00000031, +0.00002004, 3.7771402]),
                                            11: np.array([-0.00000011, -0.00016688, 3.6592567]),
                                            13: np.array([-0.00000053, -0.00002286, 3.6559695]),
                                            14: np.array([-0.00000023, +0.00003049, 3.6390489]),
                                            16: np.array([-0.00000010, -0.00031187, 3.7221495]),
                                            17: np.array([+0.00000045, -0.00120338, 3.4309781]),
                                            20: np.array([+0.00000005, -0.00057104, 3.2301115]),
                                            21: np.array([-0.00000004, -0.00049309, 3.4893479]),
                                            22: np.array([-0.00000005, -0.00031042, 3.3796082])},
                                    'K':{   2: np.array([-0.00000043, -0.00009260, 3.0418921]),
                                            3: np.array([-0.00000029, -0.00045505, 3.4133542]),
                                            4: np.array([-0.00000022, -0.00023683, 3.4237835]),
                                            5: np.array([+0.00000020, -0.00084550, 3.4077089]),
                                            6: np.array([-0.00000007, -0.00049691, 3.4352272]),
                                            7: np.array([+0.00000019, -0.00081209, 3.4240662]),
                                            8: np.array([+0.00000037, -0.00108785, 3.3656891]),
                                            10: np.array([+0.00000003, -0.00065472, 3.0381728]),
                                            11: np.array([+0.00000013, -0.00093724, 3.3202425]),
                                            12: np.array([+0.00000013, -0.00130973, 3.2355903]),
                                            13: np.array([+0.00000000, -0.00117662, 3.0231885]),
                                            14: np.array([+0.00000036, -0.00153806, 3.3215094]),
                                            16: np.array([+0.00000079, -0.00127711, 2.8699976]) }
                                    }

        self.ips_loosemount_pars = { 'H':{
                                            2: np.array([-0.00000097, +0.00180228, 3.627852]),
                                            3: np.array([-0.00000083, +0.00098296, 3.7694351]),
                                            4: np.array([-0.00000179, +0.00256885, 3.5411249]),
                                            5: np.array([-0.00000014, +0.00004835, 3.7027478]),
                                            6: np.array([-0.00000137, +0.00197794, 3.5727618]),
                                            10: np.array([-0.00000014, -0.00012634, 3.7969074]),
                                            11: np.array([-0.00000001, -0.00028753, 3.7904194]),
                                            13: np.array([-0.00000044, -0.00007479, 3.7152577]),
                                            14: np.array([-0.00000003, -0.00027106, 3.7964484]),
                                            16: np.array([-0.00000001, -0.00036968, 3.7979411]),
                                            17: np.array([-0.00000000, -0.00055775, 3.4072676]),
                                            20: np.array([+0.00000000, -0.00051203, 3.3113866]),
                                            21: np.array([+0.00000000, -0.00053837, 3.4698927]),
                                            22: np.array([-0.00000007, -0.00018335, 3.266584]) },
                                    'K':{   2: np.array([-0.00000100, +0.00133316, 3.6138606]),
                                            3: np.array([-0.00000068, +0.00070342, 3.7882576]),
                                            4: np.array([-0.00000093, +0.00126044, 3.7993036]),
                                            5: np.array([-0.00000049, +0.00036114, 3.7983821]),
                                            6: np.array([-0.00000044, +0.00024862, 3.795974]),
                                            7: np.array([-0.00000046, +0.00033508, 3.7726949]),
                                            8: np.array([-0.00000008, -0.00049619, 3.7995246]),
                                            10: np.array([+0.00000000, -0.00077256, 3.7998719]),
                                            11: np.array([+0.00000000, -0.00075347, 3.6738797]),
                                            12: np.array([-0.00000000, -0.00107012, 3.2094447]),
                                            13: np.array([+0.00000000, -0.00122076, 3.1116611]),
                                            14: np.array([-0.00000000, -0.00104468, 3.7994558]),
                                            16: np.array([+0.00000029, -0.00070009, 3.0229969]) }
                                    }

        self.bound_cut_dic = { 'H':{
                                     7: [500, 500], 8: [500, 500], 9: [500, 500], 12: [600, 150], 15: [600, 150], 18: [600, 150], 19: [600, 150],
                                    10: [250, 150],
                                    11: [600, 150],
                                    13: [200, 600],
                                    14: [700, 100],
                                    16: [400, 100],
                                    17: [1000,100],
                                    20: [500, 150]},
                               'K':{
                                    11: [200, 100],
                                    12: [900, 300],
                                    13: [200, 400],
                                    14: [150, 300]}
                               }


class orderdict_cla:
    def __init__(self,):
        self.orderdict = { 'H':{1: [1.79350, 1.81560],
                                2: [1.77602, 1.79791],
                                3: [1.75889, 1.78058],
                                4: [1.74211, 1.76360],
                                5: [1.72565, 1.74694],
                                6: [1.70952, 1.73061],
                                # 7: [1.69811, 1.71032],
                                # 8: [1.68255, 1.69465],
                                # 9: [1.66729, 1.67928],
                                10: [1.64928, 1.66785],
                                11: [1.63880, 1.65301],
                                # 12: [1.62320, 1.63487],
                                13: [1.60548, 1.61957],
                                14: [1.59742, 1.61061],
                                # 15: [1.58149, 1.59284],
                                16: [1.56694, 1.58328],
                                17: [1.56034, 1.56997],
                                # 18: [1.54197, 1.55303],
                                # 19: [1.52926, 1.54022],
                                20: [1.51677, 1.53096],
                                21: [1.50060, 1.51902],
                                22: [1.48857, 1.50682],
                                # 23: [1.47673, 1.49483],
                                # 24: [1.46510, 1.48303],
                                25: [1.45366, 1.47143]},
                           'K':{1: [2.45317, 2.48280],
                                2: [2.41999, 2.44928],
                                3: [2.38771, 2.41667],
                                4: [2.35630, 2.38493],
                                5: [2.32573, 2.35402],
                                6: [2.29596, 2.32393],
                                7: [2.26696, 2.29461],
                                8: [2.23870, 2.26603],
                                # 9: [2.21115, 2.23817],
                                10: [2.18429, 2.21101],
                                11: [2.15891, 2.18451],
                                12: [2.14410, 2.15604],
                                13: [2.10840, 2.12953],
                                14: [2.08326, 2.10624],
                                # 15: [2.05948, 2.08471],
                                16: [2.03627, 2.06121],
                                # 17: [2.01358, 2.03825],
                                # 18: [1.99142, 2.01580],
                                19: [1.96975, 1.99386],
                                20: [1.94857, 1.97241],
                                21: [1.92785, 1.95143],
                                22: [1.90759, 1.93090],
                                23: [1.88777, 1.91082],
                                24: [1.86837, 1.89116],
                                25: [1.84939, 1.87192]}
                            }

class tagstuffs:

    def __init__(self,night,watm,satm,a0contwave,continuum,ip):
        self.a0contwave = a0contwave
        self.continuum = continuum
        self.watm = watm
        self.satm = satm
        self.night = night
        self.ip = ip
